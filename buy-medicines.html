<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Buy Medicines | MyPharmAlly</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    #toast {
      visibility: hidden;
      min-width: 250px;
      margin-left: -125px;
      background-color: #26a69a;
      color: white;
      text-align: center;
      border-radius: 8px;
      padding: 14px;
      position: fixed;
      z-index: 9999;
      left: 50%;
      bottom: 30px;
      font-weight: bold;
      font-size: 1rem;
      transition: visibility 0s, opacity 0.5s ease-in-out;
      opacity: 0;
    }
    #toast.show {
      visibility: visible;
      opacity: 1;
    }
    .medicine-search {
      position: relative;
      max-width: 500px;
      margin: 0 auto 30px auto;
    }
    .medicine-search input {
      width: 100%;
      padding: 12px 16px;
      font-size: 1rem;
      border-radius: 8px;
      border: 2px solid #00796b;
      outline: none;
      box-sizing: border-box;
    }
    .suggestions-list {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      z-index: 999;
      background: white;
      border: 1px solid #ccc;
      border-top: none;
      max-height: 200px;
      overflow-y: auto;
      list-style: none;
      margin: 0;
      padding: 0;
      border-radius: 0 0 8px 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .suggestions-list li {
      padding: 10px 14px;
      cursor: pointer;
    }
    .suggestions-list li:hover {
      background-color: #f0fdf5;
    }
  </style>
</head>
<body>
  <header>
    <nav aria-label="Primary navigation">
      <button id="menu-toggle" aria-label="Toggle navigation menu" aria-expanded="false">&#9776;</button>
      <ul class="navbar" id="navbar-menu">
        <li><a href="index.html">Home</a></li>
        <li><a href="buy-medicines.html" aria-current="page">Buy Medicines</a></li>
        <li id="nav-login"><a href="login.html">Login</a></li>
        <li id="nav-signup"><a href="signup.html">Sign Up</a></li>
        <li class="profile-li" id="nav-profile" style="display:none;">
          <a href="profile.html">
            <img src="images/profile-icon.png" alt="My Profile" class="profile-icon" title="My Profile" />
          </a>
        </li>
        <li id="nav-logout" style="display:none;"><a href="#" onclick="logoutUser(event)">Log Out</a></li>
      </ul>
    </nav>
  </header>

  <main class="container">
    <h1>Buy Medicines</h1>

    <div class="medicine-search">
      <input type="text" id="searchInput" placeholder="Search for a medicine..." autocomplete="off" />
      <ul id="suggestions" class="suggestions-list"></ul>
    </div>

    <section class="Buy OTC Medicines">
      <h2>Buy OTC Medicines</h2>
      <p>Browse and add your required medicines to the cart directly.</p>
      <div class="meds-grid" id="medsGrid"></div>
    </section>

    <section class="prescription-upload">
      <h2>Prescription Medicines</h2>
      <p>To buy prescription medicines, please upload a valid prescription below.</p>

      <form class="upload-form" onsubmit="handlePrescriptionUpload(event)">
        <label for="prescription-upload" class="upload-label">
          <div class="upload-dropzone" tabindex="0">
            <p>Drag & drop your prescription here, or click to select file</p>
            <small>Accepted formats: JPG, PNG, PDF</small>
          </div>
          <input type="file" id="prescription-upload" name="prescription" accept="image/*,.pdf" required hidden />
        </label>
        <button type="submit" class="btn upload-btn">Upload Prescription</button>
      </form>

      <p style="margin-top: 18px; color: #00796b; font-weight: 600;">
        Once you upload your prescription, our agent will call you to confirm the medicine details and ensure everything is correct.
      </p>
    </section>

    <section class="call-us">
      <h2>Need Help Ordering?</h2>
      <p>
        üí¨ <strong>Chat with us on WhatsApp</strong> to quickly order your medicines, ask questions, or upload your prescription.
      </p>
      <a class="btn"
         href="https://api.whatsapp.com/send?phone=917051899758&text=Hello!+I‚Äôd+like+to+order+medicines+from+MyPharmAlly.+Can+you+assist+me%3F"
         target="_blank" rel="noopener noreferrer">
         Chat on WhatsApp
      </a>
    </section>
  </main>

  <footer class="footer-expanded">
    <div class="footer-sections">
      <div class="footer-block">
        <h4>About MyPharmAlly</h4>
        <ul>
          <li><a href="our-story.html">Our Story</a></li>
          <li><a href="our-aim.html">Our Aim</a></li>
          <li><a href="careers.html">We're Hiring</a></li>
        </ul>
      </div>
      <div class="footer-block">
        <h4>Contact Us</h4>
        <ul>
          <li><a href="mailto:support@mypharmally.com">üìß support@mypharmally.com</a></li>
          <li><a href="tel:+919876543210">üìû +91 9876543210</a></li>
          <li><a href="contact.html">‚úçÔ∏è Write us a message</a></li>
        </ul>
      </div>
      <div class="footer-block">
        <h4>Legal</h4>
        <ul>
          <li><a href="privacy-policy.html">Privacy Policy</a></li>
          <li><a href="terms-of-service.html">Terms of Service</a></li>
        </ul>
      </div>
    </div>
    <p style="text-align:center; margin-top: 30px;">¬© 2025 MyPharmAlly. All rights reserved.</p>
  </footer>

  <div id="toast"></div>

  <script>
    const allOTCmedicines = [
      "Paracetamol", "Ibuprofen", "Vitamin C Tablets", "Antacids", "Cough Syrup", "Cetirizine",
      "Disprin", "ORS Sachets", "Calcium Tablets", "Multivitamin Capsules", "Aspirin", "Eye Drops"
      // You can add more medicines here...
    ];

    const medsGrid = document.getElementById("medsGrid");

    function generateMedicineCards() {
      allOTCmedicines.forEach((name, i) => {
        const card = document.createElement("article");
        card.className = "med-card";
        card.innerHTML = `
          <img src="images/medicine-${(i % 6) + 1}.jpg" alt="${name}" onerror="this.src='images/default-medicine.jpg'" />
          <div class="med-info">
            <h3>${name}</h3>
            <p>Popular OTC medicine for common symptoms.</p>
            <div class="med-purchase">
              <span class="price">‚Çπ${30 + (i % 5) * 10} / pack</span>
              <input type="number" min="1" value="1" />
              <button class="btn add-to-cart" data-med="${name}">Add to Cart</button>
            </div>
          </div>`;
        medsGrid.appendChild(card);
      });
    }

    function filterMedicines(query) {
      const cards = document.querySelectorAll(".med-card");
      let found = false;
      cards.forEach(card => {
        const name = card.querySelector("h3").textContent.toLowerCase();
        if (name.includes(query.toLowerCase())) {
          card.style.display = "block";
          found = true;
        } else {
          card.style.display = "none";
        }
      });
      if (!found && query.trim() !== "") {
        showToast("This medicine isn't in our visible list, but may be available. Please contact us.");
      }
    }

    function handlePrescriptionUpload(event) {
      event.preventDefault();
      const fileInput = document.getElementById("prescription-upload");
      if (fileInput.files.length === 0) {
        showToast("Please select a file to upload.");
        return;
      }
      showToast("Prescription uploaded successfully!");
      fileInput.value = "";
    }

    document.addEventListener("click", function (e) {
      if (e.target.classList.contains("add-to-cart")) {
        const card = e.target.closest(".med-card");
        const medName = e.target.getAttribute("data-med");
        const qty = card.querySelector("input[type='number']").value;
        showToast(`Added ${qty} x ${medName} to your cart!`);
      }
    });

    const searchInput = document.getElementById("searchInput");
    const suggestions = document.getElementById("suggestions");

    searchInput.addEventListener("input", function () {
      const query = this.value.toLowerCase();
      suggestions.innerHTML = "";
      if (query) {
        const filtered = allOTCmedicines.filter(name =>
          name.toLowerCase().includes(query)
        );
        filtered.forEach(name => {
          const li = document.createElement("li");
          li.textContent = name;
          li.addEventListener("click", () => {
            searchInput.value = name;
            suggestions.innerHTML = "";
            filterMedicines(name);
          });
          suggestions.appendChild(li);
        });
      }
      filterMedicines(query);
    });

    function updateNavbar() {
      const loggedIn = localStorage.getItem("loggedIn") === "true";
      document.getElementById("nav-login").style.display = loggedIn ? "none" : "inline-block";
      document.getElementById("nav-signup").style.display = loggedIn ? "none" : "inline-block";
      document.getElementById("nav-profile").style.display = loggedIn ? "flex" : "none";
      document.getElementById("nav-logout").style.display = loggedIn ? "inline-block" : "none";
    }

    function logoutUser(event) {
      event.preventDefault();
      localStorage.removeItem("loggedIn");
      updateNavbar();
      setTimeout(() => window.location.href = "index.html", 1000);
    }

    document.getElementById('menu-toggle').addEventListener('click', () => {
      const navbar = document.getElementById('navbar-menu');
      navbar.classList.toggle('show');
    });

    updateNavbar();
    generateMedicineCards();
  </script>
</body>
</html>
