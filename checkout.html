<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Checkout | MyPharmAlly</title>
  <meta name="description" content="Complete your purchase on MyPharmAlly by providing shipping and payment details." />
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <nav aria-label="Primary navigation">
    <button id="menu-toggle" aria-label="Toggle navigation menu" aria-expanded="false">&#9776;</button>
    <ul class="navbar" id="navbar-menu">
      <li><a href="index.html">Home</a></li>
      <li><a href="buy-medicines.html">Buy Medicines</a></li>
      <li><a href="login.html">Login</a></li>
      <li><a href="signup.html">Sign Up</a></li>
      <li><a href="contact.html">Contact Us</a></li>
      <li><a href="about.html">About Us</a></li>
      <li><a href="cart.html">Cart</a></li>
      <li><a href="checkout.html" aria-current="page">Checkout</a></li>
    </ul>
  </nav>

  <main class="container" role="main">
    <h1>Checkout</h1>

    <section aria-label="Order summary">
      <h2>Your Order</h2>
      <table id="orderSummary" style="width: 100%; border-collapse: collapse; margin-bottom: 30px;">
        <thead>
          <tr style="background-color: #00897b; color: white;">
            <th style="padding: 10px; text-align: left;">Medicine</th>
            <th style="padding: 10px; text-align: center;">Quantity</th>
            <th style="padding: 10px; text-align: center;">Price (₹)</th>
            <th style="padding: 10px; text-align: center;">Total (₹)</th>
          </tr>
        </thead>
        <tbody id="orderItems">
          <!-- Filled by JS -->
        </tbody>
        <tfoot>
          <tr>
            <td colspan="3" style="text-align: right; font-weight: bold; padding: 10px;">Grand Total:</td>
            <td id="orderGrandTotal" style="padding: 10px; font-weight: bold; text-align: center;">₹0</td>
          </tr>
        </tfoot>
      </table>
      <p id="emptyCartMsg" style="font-style: italic; display: none;">Your cart is empty. Please add items before checking out.</p>
    </section>

    <section aria-label="Shipping information">
      <h2>Shipping Details</h2>
      <form id="checkoutForm" novalidate>
        <div class="form-group">
          <label for="fullName">Full Name <span aria-hidden="true" style="color:red;">*</span></label>
          <input type="text" id="fullName" name="fullName" required aria-required="true" />
        </div>

        <div class="form-group">
          <label for="email">Email Address <span aria-hidden="true" style="color:red;">*</span></label>
          <input type="email" id="email" name="email" required aria-required="true" />
        </div>

        <div class="form-group">
          <label for="phone">Phone Number <span aria-hidden="true" style="color:red;">*</span></label>
          <input type="tel" id="phone" name="phone" required aria-required="true" pattern="^\d{10,15}$" placeholder="Digits only" />
        </div>

        <div class="form-group">
          <label for="address">Address <span aria-hidden="true" style="color:red;">*</span></label>
          <textarea id="address" name="address" rows="3" required aria-required="true"></textarea>
        </div>

        <div class="form-group">
          <label for="city">City <span aria-hidden="true" style="color:red;">*</span></label>
          <input type="text" id="city" name="city" required aria-required="true" />
        </div>

        <div class="form-group">
          <label for="state">State/Province <span aria-hidden="true" style="color:red;">*</span></label>
          <input type="text" id="state" name="state" required aria-required="true" />
        </div>

        <div class="form-group">
          <label for="postalCode">Postal/ZIP Code <span aria-hidden="true" style="color:red;">*</span></label>
          <input type="text" id="postalCode" name="postalCode" required aria-required="true" pattern="^\d{4,10}$" />
        </div>

        <h2>Payment Information</h2>

        <div class="form-group">
          <label for="cardName">Cardholder Name <span aria-hidden="true" style="color:red;">*</span></label>
          <input type="text" id="cardName" name="cardName" required aria-required="true" />
        </div>

        <div class="form-group">
          <label for="cardNumber">Card Number <span aria-hidden="true" style="color:red;">*</span></label>
          <input type="text" id="cardNumber" name="cardNumber" required aria-required="true" pattern="^\d{13,19}$" placeholder="Digits only" />
        </div>

        <div class="form-group" style="display: flex; gap: 20px;">
          <div style="flex:1;">
            <label for="expiryDate">Expiry Date (MM/YY) <span aria-hidden="true" style="color:red;">*</span></label>
            <input type="text" id="expiryDate" name="expiryDate" required aria-required="true" pattern="^(0[1-9]|1[0-2])\/?([0-9]{2})$" placeholder="MM/YY" />
          </div>

          <div style="flex:1;">
            <label for="cvv">CVV <span aria-hidden="true" style="color:red;">*</span></label>
            <input type="password" id="cvv" name="cvv" required aria-required="true" pattern="^\d{3,4}$" placeholder="3 or 4 digits" />
          </div>
        </div>

        <button type="submit" class="btn" style="margin-top: 20px;">Place Order</button>
      </form>
    </section>

  </main>

  <footer role="contentinfo">
    <p>© 2025 MyPharmAlly. All rights reserved.</p>
  </footer>

  <script src="script.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const orderItemsContainer = document.getElementById('orderItems');
      const orderGrandTotal = document.getElementById('orderGrandTotal');
      const emptyCartMsg = document.getElementById('emptyCartMsg');
      const checkoutForm = document.getElementById('checkoutForm');

      let cart = JSON.parse(localStorage.getItem('cart')) || [];

      function renderOrderSummary() {
        orderItemsContainer.innerHTML = '';
        if (cart.length === 0) {
          emptyCartMsg.style.display = 'block';
          orderGrandTotal.textContent = '₹0';
          checkoutForm.style.display = 'none';
          return;
        }
        emptyCartMsg.style.display = 'none';
        checkoutForm.style.display = 'block';

        let total = 0;
        cart.forEach(item => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td style="padding: 10px;">${item.name}</td>
            <td style="padding: 10px; text-align: center;">${item.quantity}</td>
            <td style="padding: 10px; text-align: center;">₹${item.price.toFixed(2)}</td>
            <td style="padding: 10px; text-align: center;">₹${(item.price * item.quantity).toFixed(2)}</td>
          `;
          orderItemsContainer.appendChild(tr);
          total += item.price * item.quantity;
        });
        orderGrandTotal.textContent = `₹${total.toFixed(2)}`;
      }

      renderOrderSummary();

      checkoutForm.addEventListener('submit', e => {
        e.preventDefault();

        if (!checkoutForm.checkValidity()) {
          checkoutForm.reportValidity();
          return;
        }

        // Here you can add actual order submission logic (API call, payment integration, etc.)
        // For now, just simulate order success

        alert('Thank you for your order! Your medicines will be delivered soon.');

        // Clear cart after order
        localStorage.removeItem('cart');
        cart = [];
        renderOrderSummary();
        checkoutForm.reset();
      });
    });
  </script>

</body>
</html>
